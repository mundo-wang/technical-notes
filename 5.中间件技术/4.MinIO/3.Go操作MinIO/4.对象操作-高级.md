#### 1. 预签名`URL`

预签名`URL`主要用于预览/下载、上传、表单上传等场景。这里我们将重点讲解其中的预览/下载和上传两种方式。

预览/下载使用到`PresignedGetObject`方法，其方法签名如下所示：

```go
func (c *Client) PresignedGetObject(ctx context.Context, bucketName, objectName string,
	expires time.Duration, reqParams url.Values) (u *url.URL, err error)
```

客户端需要传入`ObjectName`信息，获取预览/下载的预签名`URL`，代码如下所示：

```go
func PresignGetURL(c *gin.Context) {
	objectName := c.Query("object-name")
	expireStr := c.DefaultQuery("expire-seconds", "3600") // 默认过期时间：1小时
	expireSeconds, _ := strconv.Atoi(expireStr)
	bucketName := utils.Config.Minio.Bucket
	minioClient, _ := utils.NewMinioClient(bucketName)
	reqParams := make(url.Values)
	// 生成预签名预览URL（GET方式）
	presignedURL, _ := minioClient.PresignedGetObject(
		c.Request.Context(),
		bucketName,
		objectName,
		time.Duration(expireSeconds)*time.Second,
		reqParams,
	)
	wresp.OK(c, presignedURL.String())
}
```

如果想在访问预签名`URL`时触发浏览器下载，在上方代码中设置该响应头参数：

```go
reqParams.Set("response-content-disposition", fmt.Sprintf("attachment; filename=%s", path.Base(objectName)))
```

`PresignedGetObject`不会对传入的`objectName`进行存在性校验，因此即使指定的`objectName`不存在，该方法也不会返回`error`。

生成的预签名预览`URL`如下所示：

```http
http://123.60.188.152:9000/mundo-bucket/images/175394876076988197.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=5lIUJj5y6wbQT2ydr238%2F20250801%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20250801T021239Z&X-Amz-Expires=3600&X-Amz-SignedHeaders=host&X-Amz-Signature=876685994c906d750d942c857b87cc434adee70906990ce2bc383989fddcf20c
```

将该`URL`复制到浏览器地址栏，或在`Apifox`中发起`GET`请求调用，即可查看对应的文件内容。

上传使用到`PresignedPutObject`方法，其方法签名如下：

```go
func (c *Client) PresignedPutObject(ctx context.Context, bucketName,
	objectName string, expires time.Duration) (u *url.URL, err error)
```

客户端需要传入`ObjectName`信息，获取上传的预签名`URL`，代码如下所示：

```go
func PresignPutURL(c *gin.Context) {
	objectName := c.Query("object-name")
	expireStr := c.DefaultQuery("expire-seconds", "3600") // 默认过期时间：1小时
	expireSeconds, _ := strconv.Atoi(expireStr)
	bucketName := utils.Config.Minio.Bucket
	minioClient, _ := utils.NewMinioClient(bucketName)
	// 生成预签名上传URL（PUT方式）
	presignedURL, _ := minioClient.PresignedPutObject(
		c.Request.Context(),
		bucketName,
		objectName,
		time.Duration(expireSeconds)*time.Second,
	)
	wresp.OK(c, presignedURL.String())
}
```

在预签名上传时，`object-name`可以是一个全新的对象路径，`MinIO`会在客户端上传成功后自动创建该对象。如果指定的`object-name`与已有对象重名，上传操作将直接覆盖原对象，且不会有任何提示。

生成的预签名上传`URL`如下所示：

```http
http://123.60.188.152:9000/mundo-bucket/images/my-test.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=5lIUJj5y6wbQT2ydr238%2F20250801%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20250801T022117Z&X-Amz-Expires=3600&X-Amz-SignedHeaders=host&X-Amz-Signature=a4a08b3e20cc63ad32e7c1fe87aac151772f2113ef1998da4237b09c60f52b0d
```

使用`Apifox`调用预签名上传的`URL`时，需要将请求方法设置为`PUT`，并在`Body`部分选择`binary`方式上传图片文件：

<img src="image/image-20250801102656860.png" alt="image-20250801102656860" style="zoom:50%;" />

预签名`URL`在设定的有效期内可用，超过该过期时间后将失效，无法继续访问。

#### 2. 手动分片上传

#### 3. 标签操作

#### 4. 其他辅助操作

当缓存服务器上的大量缓存同时过期或缓存服务器宕机时，所有请求会同时访问数据库，导致数据库压力骤增，甚至可能引发性能下降或宕机。这种情况称为“缓存雪崩”。

为了解决缓存雪崩问题，常用的方法包括：

### 1. 设置随机的过期时间

将缓存的过期时间设置为随机值，使缓存失效时间分散开，避免大量缓存同时过期，导致数据库负担过重。

### 2. 使用缓存标记来更新缓存

对于每个需要缓存的数据，可以设置两个缓存键，一个存储实际数据，另一个存储缓存标记。例如，假设我们要缓存一个用户的信息，可以有两个缓存键：一个是用户信息的键（如`user:123`），另一个是缓存标记的键（如`user:123:flag`）。

缓存标记的过期时间通常是实际缓存的一半。

具体操作如下：

1. 从缓存中读取数据时，首先检查缓存标记。
2. 如果缓存标记未过期，则直接返回缓存数据。
3. 如果缓存标记过期，系统继续返回旧的缓存数据给调用方，并触发后台任务更新缓存数据。
4. 更新完实际缓存数据后，同时更新缓存标记的过期时间。

通过设置随机过期时间和使用缓存标记，可以有效防止缓存雪崩，确保系统的稳定性。
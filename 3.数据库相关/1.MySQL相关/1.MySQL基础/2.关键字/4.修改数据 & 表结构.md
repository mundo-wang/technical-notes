### 一、修改数据（`DML`）

语法规则：

~~~ sql
update 表名 set 字段名1 = 字段值1, 字段名2 = 字段值2 where 字段名 = 字段值;
~~~

`update`可以与`case...when...then...else...end`搭配，达到类似编程语言中`switch`的效果。

具体的语法格式是这样的：
~~~ mysql
CASE
    WHEN cond1 THEN value1
    WHEN cond2 THEN value2
    ...
    WHEN condN THEN valueN
    ELSE default_value
END;
~~~
以下面这个`t_goods`表为例，要为所有价格超过`100`元的商品打五折，如果打折后小于`100`则置为`100`：

<img src="image/6b559d791ffd4c1189097970ffa79734.png" alt="商品表字段" style="zoom:67%;" />

它的`SQL`语句如下所示：
~~~ mysql
UPDATE t_goods
SET goods_price = CASE
    WHEN goods_price > 200 THEN goods_price * 0.5
    WHEN goods_price > 100 AND goods_price < 200 THEN 100
    ELSE goods_price
END;
~~~

### 二、修改表结构（`DDL`）

#### 1. 添加/删除字段

~~~ sql
alter table 表名 add 字段名 字段类型(长度);
alter table 表名 drop 字段名;
~~~

#### 2. 更改字段名/字段类型

~~~ sql
alter table 表名 change 老字段名 新字段名 字段类型(长度);
~~~

#### 3. 增加/删除字段默认值约束

~~~ sql
alter table 表名 modify 字段名 字段类型(长度) default 默认值;
alter table 表名 modify 字段名 字段类型(长度);
~~~

#### 4. 增加/删除字段非空约束

~~~ sql
alter table 表名 modify 字段名 字段类型(长度) not null;
alter table 表名 modify 字段名 字段类型(长度);
~~~

在创建或修改表结构时，应结合具体业务需求，合理设置字段的非空约束和默认值。可根据实际业务情况选择使用`NOT NULL`、`NOT NULL DEFAULT xxx`或`DEFAULT NULL`等方式进行配置：

- `NOT NULL`：当字段没有合理的默认值能够表示“空”或“未定义”状态时，应设置为`NOT NULL`。此时强制调用方必须显式传值，可有效防止因缺省导致的逻辑异常或安全隐患。如果调用方未传值，数据库报错。
- `NOT NULL DEFAULT xxx`：适用于字段在业务上具有通用的默认含义。即使调用方未显式传值，系统也能填入默认值，避免报错或产生`NULL`。适合用于状态类、标志类等字段，这种方式可以保证数据一致性，减少在查询、统计时对`NULL`的特殊判断。
- `DEFAULT NULL`：表示字段为可选项，`NULL`表示“未知”或“不适用”，有实际的业务意义，不宜强行设定默认值，否则可能引发误解或逻辑歧义。此类字段后续可能用于特殊场景处理，如数据补偿、延迟填充等。

对于可以为空的`VARCHAR`类型字段，除非有业务需求需要区分`NULL`与空字符串`''`，否则建议统一设置为`NOT NULL DEFAULT ''`，以简化逻辑处理并避免潜在的空值判断问题。

#### 5. 增加/删除字段唯一约束（唯一索引）

~~~ sql
alter table 表名 modify 字段名 字段类型(长度) unique;
alter table 表名 drop index 字段名;
~~~

在`MySQL`中，添加唯一约束会自动在该字段上创建一个和字段名相同的唯一索引，而添加非空约束并不会创建索引。

如果想指定索引名，也可以这样创建这个唯一约束（唯一索引）：

```mysql
ALTER TABLE 表名 ADD CONSTRAINT 索引名 UNIQUE (字段名);
```


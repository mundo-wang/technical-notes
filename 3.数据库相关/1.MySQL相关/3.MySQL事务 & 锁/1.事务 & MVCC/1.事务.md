### 事务及其四个特性（`ACID`）

事务是指一组作为单个逻辑单元执行的一系列操作，这些操作要么全部成功，要么全部回滚。事务主要涉及`DML`语句，因此可以理解为绑定在一起的多条`DML`语句同时成功或失败。

事务的四个特性（`ACID`）包括：

1. 原子性（`Atomicity`）：一个事务中所有`DML`操作，要么同时成功要么全部失败回滚。
2. 一致性（`Consistency`）：事务完成前后，数据库的数据始终是正确的、符合规定的规则和约束。
3. 隔离性（`Isolation`）：事务之间的隔离级别包括：读未提交、读已提交、可重复读、序列化。
4. 持久性（`Durability`）：事务结束后的修改数据永久保存在数据库中，即使系统故障数据也不会丢失。

`MySQL`默认的事务隔离级别是可重复读（`Repeatable Read`），而`PostgreSQL`和`Oracle`默认为读已提交（`Read Committed`）。

### 事务的四种隔离级别

#### 1. 读未提交（`Read Uncommitted`）

最低的隔离级别。写事务`A`还未提交的数据就被读事务`B`读取，这会导致脏读问题。

> 脏读（`Dirty Read`）：读到尚未提交的事务数据，如果事务回滚，这个数据就是脏数据。

#### 2. 读已提交（`Read Committed`）

写事务`A`提交后，读事务`B`才能读取到写事务`A`提交的数据。这解决了脏读问题，但未解决不可重复读的问题。

> 不可重复读（`Non-repeatable Read`）：同一事务两次读取数据之间，有其他事务修改了该数据，导致查询结果不同。

#### 3. 可重复读（`Repeatable Read`）

在开启读事务`B`时，相当于给当前读取的数据范围加了写锁。在读事务`B`提交之前都不会释放写锁，这样之后读取到的数据值不会变化，解决了不可重复读的问题，但未解决幻读（`Phantom Read`）的问题。

> 幻读（`Phantom Read`）：同一事务两次读取数据之间，有其他事务在此数据范围内进行了数据的增删，导致查询结果不同。

不可重复读主要关注数据值的变化（修改），而幻读则关注数据行数的变化（增删）。

#### 4. 序列化（`Serializable`）

数据库事务的最高隔离级别。在此级别下，事务串行执行，一个事务提交后，另一个事务才可以开启。可以避免脏读、不可重复读、幻读等问题，但效率低下，耗费数据库性能，不推荐使用。